<script>
  $(".follow-link").click(function(event){
    event.preventDefault();
    var this_ = $(this)
    var followUrl = this_.attr("href")
    $.ajax({
      url: followUrl,
      method: "GET",
      data: {},
      success: function(data){
        console.log(data.username)
        if (data.action == "follow"){
          this_.attr("href", "{% url 'followers:unfollow' username=1 %}".replace(/1/, data.username.toString()))
          this_.text("Unfollow")
        } else {
          this_.attr("href", "{% url 'followers:follow' username=1 %}".replace(/1/, data.username.toString()))
          this_.text("Follow")
        }
      }, error: function(error){
        console.log(error)
      }
    })
  })
</script>
